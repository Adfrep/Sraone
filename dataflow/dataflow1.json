{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dataset5001",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "dataset5001",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "output",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "join1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          RISK_ID as string,",
				"          RISK_TERM as short,",
				"          RISK_AMEND as short,",
				"          AGENCY_ID as short,",
				"          AGENT_ID as short,",
				"          APP_DATE_CREATED as timestamp,",
				"          APP_DATE_UPDATED as timestamp,",
				"          COMMISSION_PLAN as string,",
				"          EFFECTIVE_DATE as date,",
				"          EXPIRATION_DATE as date,",
				"          POLICY_FORM as string,",
				"          PREMIUM_GROUP as string,",
				"          RATE_BOOK as string,",
				"          RISK_ORIGIN as string,",
				"          STATE as string,",
				"          STATUS_UW as string,",
				"          TOTAL_APPLICATION_PREMIUM as double,",
				"          ALL_OTHER_PERILS_DED as string,",
				"          BINDER as boolean,",
				"          BINDER_EFFECTIVE_DATE_TIME as string,",
				"          BINDER_EXPIRE_DATE_TIME as string,",
				"          BUS_PROP_ON_PREM_LIMIT as double,",
				"          DEBRIS_REMOVAL as short,",
				"          DWELLING_LIMIT as integer,",
				"          EARTHQUAKE_DED as string,",
				"          EQUIPMENT_BREAKDOWN as string,",
				"          FIRE_DEPT_SERVICE_CHARGE_LIMIT as short,",
				"          FUNGI_LIABILITY_LIMIT as integer,",
				"          FUNGI_PROPERTY_LIMIT as short,",
				"          HURRICANE_DED as string,",
				"          ID_THEFT_LIMIT as boolean,",
				"          INCIDENTAL_FARMING_LIABILITY as string,",
				"          INCIDENTAL_OCCUPANCY as boolean,",
				"          INCIDENTAL_OCCUPANCY_DESC as string,",
				"          LOSS_ASSESSMENT_LIMIT as short,",
				"          LOSS_OF_USE_LIMIT as integer,",
				"          LOSS_OF_USE_PCT as string,",
				"          MEDICAL_PAYMENTS_LIMIT as string,",
				"          ORDINANCE_LAW as string,",
				"          OTHER_STRUCTURES_LIMIT as integer,",
				"          OTHER_STRUCTURES_PCT as short,",
				"          OPENING_WINDOW_PROT as boolean,",
				"          PERSONAL_LIABILITY_LIMIT as string,",
				"          PERSONAL_PROPERTY_LIMIT as integer,",
				"          PERSONAL_PROPERTY_PCT as string,",
				"          REPLACEMENT_COST_CONTENTS as boolean,",
				"          REPLACEMENT_COST_DWELLING as boolean,",
				"          SINKHOLE_COV as boolean,",
				"          THEFT_DED as string,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_ELEC as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_GUNS as short,",
				"          UNSCHEDULED_INCR_COV_C_JWF as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_MONEY as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_SECURITIES as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_SILVER as short,",
				"          UNSCHEDULED_REFRIGERATED_FOOD as boolean,",
				"          WATER_SEWER_BACKUP as short,",
				"          WIND_HAIL_DED as string,",
				"          AGENT_REMARKS as string,",
				"          ANIMALS_ON_PREMISES as boolean,",
				"          APARTMENTS as boolean,",
				"          ARSON as short,",
				"          BREED as short,",
				"          BUILDING_CODE_GRADE as string,",
				"          BUSINESS_ON_PREMISE as short,",
				"          CONSTRUCTION_TYPE as string,",
				"          COVERAGE_DECLINED as short,",
				"          COVERAGE_DECLINED_DESC as string,",
				"          DATE_AT_CURRENT_RESIDENCE as string,",
				"          PURCHASE_DATE as date,",
				"          DAY_CARE as short,",
				"          DEADBOLT_LOCKS as boolean,",
				"          FIRE_HYDRANT_DISTANCE as short,",
				"          DISTANCE_TO_COAST as integer,",
				"          DOGS_ON_PREMISES as short,",
				"          DWELLING_LOCATION as boolean,",
				"          DWELLING_REPLACEMENT_VALUE as integer,",
				"          EARTHQUAKE_ZONE as string,",
				"          EXOTIC_ANIMALS as short,",
				"          FIRE_DIVISIONS as boolean,",
				"          FIRE_EXTINGUISHER as boolean,",
				"          FIRE_SPRINKLER as boolean,",
				"          FIRE_STATION as string,",
				"          FIRE_STATION_DISTANCE as short,",
				"          FORECLOSURE_OR_REPO as short,",
				"          FORECLOSURE_OR_REPO_DESC as string,",
				"          FOUNDATION as string,",
				"          HEAT_TYPE_PRIMARY as string,",
				"          HEAT_TYPE_SECONDARY as string,",
				"          LATITUDE as string,",
				"          LONGITUDE as string,",
				"          NON_SMOKER as short,",
				"          NUM_OF_STORIES as double,",
				"          NUMBER_OF_FAMILIES as boolean,",
				"          OCCUPIED_BY as string,",
				"          PREMIUM_TAX_CODE as string,",
				"          PRIOR_CARRIER as string,",
				"          PRIOR_CARRIER_OTHER as string,",
				"          PRIOR_DATE_EXPIRE as date,",
				"          PRIOR_POLICY_NBR as string,",
				"          PROPERTY_ADDRESS_1 as string,",
				"          PROPERTY_ADDRESS_2 as string,",
				"          PROPERTY_CITY as string,",
				"          PROPERTY_COUNTY as string,",
				"          PROPERTY_STATE as string,",
				"          PROPERTY_ZIP as integer,",
				"          PROTECTION_CLASS as string,",
				"          PROTECTION_TYPE_BURGLAR as string,",
				"          PROTECTION_TYPE_SMOKE as string,",
				"          PROTECTION_TYPE_TEMPERATURE as string,",
				"          PURCHASE_PRICE as integer,",
				"          RENO_HEAT_YEAR as short,",
				"          RENO_PLUMBING_YEAR as short,",
				"          RENO_ROOF_YEAR as short,",
				"          RENO_WIRING_YEAR as short,",
				"          RESIDENCE_EMPLOYEES_DESC as string,",
				"          RESIDENCE_EMPLOYEES_FT as boolean,",
				"          RESIDENCE_EMPLOYEES_PT as string,",
				"          ROOF_MATERIAL as string,",
				"          ROOF_SHAPE as string,",
				"          ROOMS as boolean,",
				"          SECURITY_ATTENDANT as short,",
				"          SQ_FEET_TOTAL as short,",
				"          STRUCTURE_TYPE as string,",
				"          SWIM_POOL as string,",
				"          SWIM_POOL_DIVE as short,",
				"          SWIM_POOL_SLIDE as short,",
				"          TERRITORY as string,",
				"          TRAMPOLINE_ON_PREMISES as short,",
				"          UNITS_IN_FIRE_DIVISION as boolean,",
				"          USAGE_TYPE as string,",
				"          YEAR_BUILT as short,",
				"          CO_INSURED_DOB as date,",
				"          CO_INSURED_EMAIL as string,",
				"          CO_INSURED_LAST_NAME as string,",
				"          CO_INSURED_MAIL_ADDRESS_1 as string,",
				"          CO_INSURED_MAIL_ADDRESS_2 as string,",
				"          CO_INSURED_MAIL_CITY as string,",
				"          CO_INSURED_MAIL_STATE as string,",
				"          CO_INSURED_MAIL_ZIP as string,",
				"          CO_INSURED_MARITAL_STATUS as string,",
				"          CO_INSURED_MIDDLE_NAME as string,",
				"          CO_INSURED_FIRST_NAME as string,",
				"          CO_INSURED_OCCUPATION as string,",
				"          CO_INSURED_PHONE_PRI as string,",
				"          CO_INSURED_PHONE_PRI_TYPE as string,",
				"          CO_INSURED_SUFFIX as string,",
				"          INSURED_DOB as date,",
				"          INSURED_EMAIL as string,",
				"          INSURED_FIRST_NAME as string,",
				"          INSURED_LAST_NAME as string,",
				"          INSURED_MAIL_ADDRESS_1 as string,",
				"          INSURED_MAIL_ADDRESS_2 as string,",
				"          INSURED_MAIL_CITY as string,",
				"          INSURED_MAIL_STATE as string,",
				"          INSURED_MAIL_ZIP as integer,",
				"          INSURED_MARITAL_STATUS as string,",
				"          INSURED_MIDDLE_NAME as string,",
				"          INSURED_OCCUPATION as string,",
				"          INSURED_PHONE_PRI as string,",
				"          INSURED_PHONE_PRI_TYPE as string,",
				"          INSURED_PHONE_SEC as string,",
				"          INSURED_PHONE_SEC_TYPE as string,",
				"          INSURED_PRIOR_ADDRESS_1 as string,",
				"          INSURED_PRIOR_ADDRESS_2 as string,",
				"          INSURED_PRIOR_CITY as string,",
				"          INSURED_PRIOR_STATE as string,",
				"          INSURED_PRIOR_ZIP as string,",
				"          INSURED_SALUTATION as string,",
				"          INSURED_SUFFIX as string,",
				"          BILLING_PLAN as boolean,",
				"          SEND_BILL_TO as string,",
				"          SEND_BILL_TO_RENEWAL as string,",
				"          BEGIN_DATE_RANGE as date,",
				"          END_DATE_RANGE as date,",
				"          {{PRODUCTION_DATE_CREATED} as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source(output(",
				"          RISK_ID as string,",
				"          RISK_TERM as short,",
				"          RISK_AMEND as short,",
				"          AGENCY_ID as short,",
				"          AGENT_ID as short,",
				"          APP_DATE_CREATED as timestamp,",
				"          APP_DATE_UPDATED as timestamp,",
				"          COMMISSION_PLAN as string,",
				"          EFFECTIVE_DATE as date,",
				"          EXPIRATION_DATE as date,",
				"          POLICY_FORM as string,",
				"          PREMIUM_GROUP as string,",
				"          RATE_BOOK as string,",
				"          RISK_ORIGIN as string,",
				"          STATE as string,",
				"          STATUS_UW as string,",
				"          TOTAL_APPLICATION_PREMIUM as double,",
				"          ALL_OTHER_PERILS_DED as string,",
				"          BINDER as boolean,",
				"          BINDER_EFFECTIVE_DATE_TIME as string,",
				"          BINDER_EXPIRE_DATE_TIME as string,",
				"          BUS_PROP_ON_PREM_LIMIT as double,",
				"          DEBRIS_REMOVAL as short,",
				"          DWELLING_LIMIT as integer,",
				"          EARTHQUAKE_DED as string,",
				"          EQUIPMENT_BREAKDOWN as string,",
				"          FIRE_DEPT_SERVICE_CHARGE_LIMIT as short,",
				"          FUNGI_LIABILITY_LIMIT as integer,",
				"          FUNGI_PROPERTY_LIMIT as short,",
				"          HURRICANE_DED as string,",
				"          ID_THEFT_LIMIT as boolean,",
				"          INCIDENTAL_FARMING_LIABILITY as string,",
				"          INCIDENTAL_OCCUPANCY as boolean,",
				"          INCIDENTAL_OCCUPANCY_DESC as string,",
				"          LOSS_ASSESSMENT_LIMIT as short,",
				"          LOSS_OF_USE_LIMIT as integer,",
				"          LOSS_OF_USE_PCT as string,",
				"          MEDICAL_PAYMENTS_LIMIT as string,",
				"          ORDINANCE_LAW as string,",
				"          OTHER_STRUCTURES_LIMIT as integer,",
				"          OTHER_STRUCTURES_PCT as short,",
				"          OPENING_WINDOW_PROT as boolean,",
				"          PERSONAL_LIABILITY_LIMIT as string,",
				"          PERSONAL_PROPERTY_LIMIT as integer,",
				"          PERSONAL_PROPERTY_PCT as string,",
				"          REPLACEMENT_COST_CONTENTS as boolean,",
				"          REPLACEMENT_COST_DWELLING as boolean,",
				"          SINKHOLE_COV as boolean,",
				"          THEFT_DED as string,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_ELEC as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_GUNS as short,",
				"          UNSCHEDULED_INCR_COV_C_JWF as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_MONEY as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_SECURITIES as short,",
				"          UNSCHEDULED_INCR_COV_C_SPECIAL_SILVER as short,",
				"          UNSCHEDULED_REFRIGERATED_FOOD as boolean,",
				"          WATER_SEWER_BACKUP as short,",
				"          WIND_HAIL_DED as string,",
				"          AGENT_REMARKS as string,",
				"          ANIMALS_ON_PREMISES as boolean,",
				"          APARTMENTS as boolean,",
				"          ARSON as short,",
				"          BREED as short,",
				"          BUILDING_CODE_GRADE as string,",
				"          BUSINESS_ON_PREMISE as short,",
				"          CONSTRUCTION_TYPE as string,",
				"          COVERAGE_DECLINED as short,",
				"          COVERAGE_DECLINED_DESC as string,",
				"          DATE_AT_CURRENT_RESIDENCE as string,",
				"          PURCHASE_DATE as date,",
				"          DAY_CARE as short,",
				"          DEADBOLT_LOCKS as boolean,",
				"          FIRE_HYDRANT_DISTANCE as short,",
				"          DISTANCE_TO_COAST as integer,",
				"          DOGS_ON_PREMISES as short,",
				"          DWELLING_LOCATION as boolean,",
				"          DWELLING_REPLACEMENT_VALUE as integer,",
				"          EARTHQUAKE_ZONE as string,",
				"          EXOTIC_ANIMALS as short,",
				"          FIRE_DIVISIONS as boolean,",
				"          FIRE_EXTINGUISHER as boolean,",
				"          FIRE_SPRINKLER as boolean,",
				"          FIRE_STATION as string,",
				"          FIRE_STATION_DISTANCE as short,",
				"          FORECLOSURE_OR_REPO as short,",
				"          FORECLOSURE_OR_REPO_DESC as string,",
				"          FOUNDATION as string,",
				"          HEAT_TYPE_PRIMARY as string,",
				"          HEAT_TYPE_SECONDARY as string,",
				"          LATITUDE as string,",
				"          LONGITUDE as string,",
				"          NON_SMOKER as short,",
				"          NUM_OF_STORIES as double,",
				"          NUMBER_OF_FAMILIES as boolean,",
				"          OCCUPIED_BY as string,",
				"          PREMIUM_TAX_CODE as string,",
				"          PRIOR_CARRIER as string,",
				"          PRIOR_CARRIER_OTHER as string,",
				"          PRIOR_DATE_EXPIRE as date,",
				"          PRIOR_POLICY_NBR as string,",
				"          PROPERTY_ADDRESS_1 as string,",
				"          PROPERTY_ADDRESS_2 as string,",
				"          PROPERTY_CITY as string,",
				"          PROPERTY_COUNTY as string,",
				"          PROPERTY_STATE as string,",
				"          PROPERTY_ZIP as integer,",
				"          PROTECTION_CLASS as string,",
				"          PROTECTION_TYPE_BURGLAR as string,",
				"          PROTECTION_TYPE_SMOKE as string,",
				"          PROTECTION_TYPE_TEMPERATURE as string,",
				"          PURCHASE_PRICE as integer,",
				"          RENO_HEAT_YEAR as short,",
				"          RENO_PLUMBING_YEAR as short,",
				"          RENO_ROOF_YEAR as short,",
				"          RENO_WIRING_YEAR as short,",
				"          RESIDENCE_EMPLOYEES_DESC as string,",
				"          RESIDENCE_EMPLOYEES_FT as boolean,",
				"          RESIDENCE_EMPLOYEES_PT as string,",
				"          ROOF_MATERIAL as string,",
				"          ROOF_SHAPE as string,",
				"          ROOMS as boolean,",
				"          SECURITY_ATTENDANT as short,",
				"          SQ_FEET_TOTAL as short,",
				"          STRUCTURE_TYPE as string,",
				"          SWIM_POOL as string,",
				"          SWIM_POOL_DIVE as short,",
				"          SWIM_POOL_SLIDE as short,",
				"          TERRITORY as string,",
				"          TRAMPOLINE_ON_PREMISES as short,",
				"          UNITS_IN_FIRE_DIVISION as boolean,",
				"          USAGE_TYPE as string,",
				"          YEAR_BUILT as short,",
				"          CO_INSURED_DOB as date,",
				"          CO_INSURED_EMAIL as string,",
				"          CO_INSURED_LAST_NAME as string,",
				"          CO_INSURED_MAIL_ADDRESS_1 as string,",
				"          CO_INSURED_MAIL_ADDRESS_2 as string,",
				"          CO_INSURED_MAIL_CITY as string,",
				"          CO_INSURED_MAIL_STATE as string,",
				"          CO_INSURED_MAIL_ZIP as string,",
				"          CO_INSURED_MARITAL_STATUS as string,",
				"          CO_INSURED_MIDDLE_NAME as string,",
				"          CO_INSURED_FIRST_NAME as string,",
				"          CO_INSURED_OCCUPATION as string,",
				"          CO_INSURED_PHONE_PRI as string,",
				"          CO_INSURED_PHONE_PRI_TYPE as string,",
				"          CO_INSURED_SUFFIX as string,",
				"          INSURED_DOB as date,",
				"          INSURED_EMAIL as string,",
				"          INSURED_FIRST_NAME as string,",
				"          INSURED_LAST_NAME as string,",
				"          INSURED_MAIL_ADDRESS_1 as string,",
				"          INSURED_MAIL_ADDRESS_2 as string,",
				"          INSURED_MAIL_CITY as string,",
				"          INSURED_MAIL_STATE as string,",
				"          INSURED_MAIL_ZIP as integer,",
				"          INSURED_MARITAL_STATUS as string,",
				"          INSURED_MIDDLE_NAME as string,",
				"          INSURED_OCCUPATION as string,",
				"          INSURED_PHONE_PRI as string,",
				"          INSURED_PHONE_PRI_TYPE as string,",
				"          INSURED_PHONE_SEC as string,",
				"          INSURED_PHONE_SEC_TYPE as string,",
				"          INSURED_PRIOR_ADDRESS_1 as string,",
				"          INSURED_PRIOR_ADDRESS_2 as string,",
				"          INSURED_PRIOR_CITY as string,",
				"          INSURED_PRIOR_STATE as string,",
				"          INSURED_PRIOR_ZIP as string,",
				"          INSURED_SALUTATION as string,",
				"          INSURED_SUFFIX as string,",
				"          BILLING_PLAN as boolean,",
				"          SEND_BILL_TO as string,",
				"          SEND_BILL_TO_RENEWAL as string,",
				"          BEGIN_DATE_RANGE as date,",
				"          END_DATE_RANGE as date,",
				"          {{PRODUCTION_DATE_CREATED} as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source2",
				"source1, source2 join(source1@RISK_ID == source2@RISK_ID",
				"     && source1@RISK_TERM == source2@RISK_TERM,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"join1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}